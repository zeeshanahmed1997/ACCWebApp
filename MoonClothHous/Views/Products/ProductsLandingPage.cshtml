@*@await Html.PartialAsync("~/Views/Miscellaneous/SlideShow.cshtml")*@

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Page with Filters</title>
    <link rel="stylesheet" href="~/css/Index.css" asp-append-version="true" />
    <!-- Add these lines to your _Layout.cshtml -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        body {
            background: linear-gradient(to top, silver, gray);
            color: Black;
            /* Set the text color to white */
        }

        .text-center {
            text-align: center;
        }
    </style>
</head>

<body>
    <section class="container-sm col-sm-12 homePageImage">
        <img class="productImage" src="/Images/homepage.jpg" alt="Product Image" style="width:100%">
    </section>
    <section class="mt-4">
        <h4 class="FeaturedProductsHeading">Featured Products</h4>
        <div class="container-sm">
            <div class="row">
                <div class="col-sm-12">
                    <div class="row">
                        @foreach (var product in Model)
                        {
                            <div class="col-sm">
                                <div class="product">
                                    <a href="#" class="product-link" data-toggle="modal" data-target="#productDetailModal"
                                       data-id="@product.ProductId" data-image-url="@Url.Content(product.ImageUrl)" data-name="@product.CreatedAt"
                                       data-updatedAt="@product.UpdatedAt">
                                        <img class="productImage" src="@product.ImageUrl" alt="Product Image">
                                    </a>
                                    <p>@product.IsPrimary</p>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Product Details Modal -->
        <div class="modal fade" id="productDetailModal" tabindex="-1" role="dialog"
             aria-labelledby="productDetailModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="productDetailModalLabel">Product Details</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <img id="productImage" src="" alt="Product Image" class="img-fluid">
                            </div>
                            <div class="col-md-6">
                                @* <h4 id="productName"></h4> *@
                                <p id="productDescription"></p>
                                <p>Price: $<span id="productPrice"></span></p>
                                <p>
                                    Select Color:
                                    <select id="colorSelect" class="form-control">
                                        <option value="Red">Red</option>
                                        <option value="Blue">Blue</option>
                                        <option value="Green">Green</option>
                                    </select>
                                </p>
                                <p>
                                    Quantity:
                                    <input type="number" id="quantityInput" class="form-control" value="1">
                                </p>
                                <button class="btn btn-primary btn-block add-to-cart-button">
                                    Add to Cart
                                </button>
                            </div>
                        </div>
                        <h5>Product Reviews</h5>
                        <p>
                            Rating:
                            <span id="starRating">
                                <!-- Add star icons here -->
                            </span>
                        </p>
                        <!-- Add the review section here -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Add your JavaScript code for filtering and rendering products here -->

</body>

<script>
        // Product modal trigger
$('.product-link').on('click', function () {
    var productId = $(this).data('id');
    var productPrice = $(this).data('price');
    var productImage = $(this).data('image-url');
    var productName = $(this).data('name');
    var productUpdatedAt = $(this).data('updatedat');

    // Update the modal's content based on the product clicked
    $('#productImage').attr('src', productImage); // This line sets the image source
    // Set data attributes for the add-to-cart button
    $('.add-to-cart-button').data('product-id', productId);
    $('.add-to-cart-button').data('product-price', productPrice);
    $('.add-to-cart-button').data('product-image', productImage);
});
$('.add-to-cart-button').on('click', function () {
    // Use the stored data attributes when the button is clicked
    var productId = $(this).data('product-id');
    var quantity = $('#quantityInput').val();
    var color = $('#colorSelect').val();

    // Prepare the data to be sent
    var data = {
        productId: productId,
        quantity: quantity,
        color: color
    };
function updateCartCount() {
    var currentCount = parseInt($('#cartCount').text()); // Get the current count
    $('#cartCount').text(currentCount + 1); // Increment and display the new count
}

    // AJAX call to the server
    $.ajax({
        url: '@Url.Action("AddToCart", "Products")',
        type: 'POST',
        contentType: 'application/json',
        data: JSON.stringify(data),
success: function (response) {
    alert('Product added to cart:', response);
    updateCartCount(); // Call a function to update the cart count
    $('#productDetailModal').modal('hide');
},

        error: function (xhr, status, error) {
            alert('Error adding to cart:', xhr.responseText);
        }
    });
});
</script>
</html>